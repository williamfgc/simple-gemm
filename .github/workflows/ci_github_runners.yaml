name: CI GitHub Runners

on:
 push:
  branches:
    - main
 pull_request:
   branches:
    - main

jobs:
 linux:
  runs-on: ubuntu-latest
  container: ${{matrix.container}}
  env: 
   GH_JOBNAME: ${{matrix.jobname}}
   GH_OS: Linux
  strategy:
    fail-fast: false
    matrix: 
     jobname: [ubuntu20-julia1.7.3]
  
  steps:
  - name: Verify Julia
    run: julia --version
  
  - name: Checkout Action
    uses: actions/checkout@v3 

  - name: Instantiate
    run: |
     echo $GITHUB_WORKSPACE/julia/GemmDenseThreads
     cd $GITHUB_WORKSPACE/julia/GemmDenseThreads
     julia --project  -e 'using Pkg; Pkg.instantiate();'

  - name: Test
    run: jjulia -t 2 --project test/runtest.jl
